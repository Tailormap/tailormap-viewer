<div class="map-control-button-container"
     [class.simple-search-container]="!isMobile()"
     [class.simple-search-container--is-active]="active() && !isMobile()"
     [class.simple-search-container--mobile]="isMobile() && !fullScreen()"
     [class.simple-search-container--mobile-is-active]="isMobile() && active() && !fullScreen()"
     [class.simple-search-container--full-screen]="fullScreen()"
     [class.no-transition]="disableTransition()"
     (keyup.escape)="toggle(true)">

  <div class="button-and-form-field">
    <button mat-flat-button
            class="map-control-button"
            [class.toggle-button--active]="active()"
            [tmTooltip]="label"
            (click)="toggle()">
      <mat-icon svgIcon="search"></mat-icon>
    </button>

    @if (active()) {
      <div class="simple-search-field-wrapper">
        @if (isMobile()) {
          <div class="mobile-search-field">
            <input type="text"
                   tmAutoFocus
                   class="mobile-search-field-input"
                   (keydown.enter)="search()"
                   [placeholder]="label"
                   [value]="displayLabel(searchControl.value)"
                   (input)="searchControl.setValue($any($event.target).value)">
          </div>
        } @else {
          <mat-form-field appearance="outline">
            <mat-label>{{label}}</mat-label>
            <input matInput
                   type="text"
                   tmAutoFocus
                   class="search-field"
                   (keydown.enter)="search()"
                   [placeholder]="label"
                   [formControl]="searchControl"
                   [matAutocomplete]="auto" />
            <mat-autocomplete autoActiveFirstOption
                              class="search-panel"
                              (opened)="panelOpen(true)"
                              (closed)="panelOpen(false)"
                              #auto="matAutocomplete"
                              [displayWith]="displayLabel">
              <tm-simple-search-results
                [searchResults]="searchResults$ | async"
                [searchStatus]="searchStatus()"
                (scrolledToGroup)="blurSearchField()">
              </tm-simple-search-results>
            </mat-autocomplete>
          </mat-form-field>
        }
      </div>
    }
  </div>

  @if (fullScreen()) {
    <div class="inline-search-results">
      <tm-simple-search-results
        [searchResults]="searchResults$ | async"
        [searchStatus]="searchStatus()"
        (scrolledToGroup)="blurSearchField()">
      </tm-simple-search-results>
    </div>
  }

</div>
