<form [formGroup]="filterForm">

  <div class="attribute-filter-info">
    @if (!filterForm.get('layer')?.value) {
      <div i18n="@@admin-core.application.filters.select-layer">Select a layer to filter</div>
    } @else if (!filterForm.get('attribute')?.value) {
      <div i18n="@@admin-core.application.filters.filter-on-layer">
        Filter on layer '{{ filterForm.get('layer')?.value?.geoServiceLayer?.layerSettings?.title
      || filterForm.get('layer')?.value?.geoServiceLayer?.title }}'
      </div>
    } @else {
      <div i18n="@@admin-core.application.filters.filter-on--attribute-layer">
        Filter for attribute '{{ filterForm.get('attribute')?.value }}' on layer
        '{{ filterForm.get('layer')?.value?.geoServiceLayer?.layerSettings?.title
      || filterForm.get('layer')?.value?.geoServiceLayer?.title }}'
      </div>
    }
  </div>

  <div class="filter-tool">
    <mat-form-field appearance="outline">
      <mat-label i18n="@@admin-core.application.filters.tool">Tool</mat-label>
      <mat-select formControlName="tool" placeholder="Tool">
        @for (tool of filterToolOptions; track tool) {
          <mat-option [value]="tool.value">{{ tool.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  @if(newFilter) {
    <div class="layers-and-attributes">
      <tm-admin-application-filter-attribute-list [featureType]="featureType$ | async"
                                    [loadingFeatureType]="loadingFeatureType$ | async"
                                    (selectAttribute)="setSelectedAttribute($event)"></tm-admin-application-filter-attribute-list>
    </div>
  }

  @if (filterForm.get('attribute')?.value && filterForm.get('attributeType')?.value) {
    @if (filterForm.get('tool')?.value === "PRESET_STATIC") {
      <div class="attribute-filter-values">
        <tm-attribute-filter
          [attributeType]="filterForm.get('attributeType')!.value!"
          [filter]="filterData"
          [uniqueValues$]="uniqueValuesStrings$"
          (filterChanged)="setFilterValues($event)"></tm-attribute-filter>
      </div>
    } @else if (filterForm.get('tool')?.value === "SLIDER") {
      <div class="slider-filter-form">
        <tm-admin-application-slider-filter-form
          [attributeType]="filterForm.get('attributeType')!.value!"
          [sliderFilter]="filterForm.get('editFilterConfiguration')?.value ?? null"
          [uniqueValues]="uniqueValues$ | async"
          (updateSliderFilter)="setEditFilterConfiguration($event)"></tm-admin-application-slider-filter-form>
      </div>
    }
  }
</form>
